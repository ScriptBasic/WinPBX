' ########################################################################################
' Microsoft Windows
' File: CertExit.inc
' Copyright (c) 2011 José Roca
' Portions Copyright (c) Microsoft Corporation.
' All Rights Reserved.
' THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
' EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
' MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
' ########################################################################################

#INCLUDE THIS ONCE
%CERTEXIT_INC = 1

'/* header files for imported files */
#INCLUDE ONCE "wtypes.inc"
#INCLUDE ONCE "certmod.inc"

%EXITEVENT_INVALID               = &H0     ' // Invalid event
%EXITEVENT_CERTISSUED            = &H1     ' // Certificate issued
%EXITEVENT_CERTPENDING           = &H2     ' // Certificate pending
%EXITEVENT_CERTDENIED            = &H4     ' // Certificate denied
%EXITEVENT_CERTREVOKED           = &H8     ' // Certificate revoked
%EXITEVENT_CERTRETRIEVEPENDING   = &H10    ' // Certificate retrieval
%EXITEVENT_CRLISSUED             = &H20    ' // CRL issued
%EXITEVENT_SHUTDOWN              = &H40    ' // Service shutdown
%EXITEVENT_STARTUP               = &H80    ' // Service startup, fake event generated by exit module
%EXITEVENT_CERTIMPORTED          = &H200   ' // Certificate Imported

' ########################################################################################
' Interface name = ICertExit
' IID = E19AE1A0-7364-11D0-8816-00A0C903B83C
' Inherited interface = IDispatch
' ########################################################################################

#IF NOT %DEF(%ICertExit_INTERFACE_DEFINED)
    %ICertExit_INTERFACE_DEFINED = 1

$IID_ICertExit = GUID$("{E19AE1A0-7364-11D0-8816-00A0C903B83C}")

INTERFACE ICertExit $IID_ICertExit

   INHERIT IDispatch

   ' =====================================================================================
   METHOD Initialize ( _                                ' VTable offset = 28
     BYVAL strConfig AS WSTRING _                       ' __in const BSTR strConfig
   ) AS LONG                                            ' __retval_out LONG *pEventMask
   ' =====================================================================================
   METHOD Notify ( _                                    ' VTable offset = 32
     BYVAL ExitEvent AS LONG _                          ' __in LONG ExitEvent
   , BYVAL Context AS LONG _                            ' __in LONG Context
   )                                                    ' void
   ' =====================================================================================
   METHOD GetDescription ( _                            ' VTable offset = 36
   ) AS WSTRING                                         ' __retval_out BSTR *pstrDescription
   ' =====================================================================================

END INTERFACE

#ENDIF   ' /* __ICertExit_INTERFACE_DEFINED__ */


' ########################################################################################
' Interface name = ICertExit2
' IID = 0ABF484B-D049-464D-A7ED-552E7529B0FF
' Inherited interface = ICertExit
' ########################################################################################

#IF NOT %DEF(%ICertExit2_INTERFACE_DEFINED)
    %ICertExit2_INTERFACE_DEFINED = 1

$IID_ICertExit2 = GUID$("{0ABF484B-D049-464D-A7ED-552E7529B0FF}")

INTERFACE ICertExit2 $IID_ICertExit2

   INHERIT IDispatch

   ' =====================================================================================
   ' ICertExit methods
   ' =====================================================================================
   METHOD Initialize ( _                                ' VTable offset = 28
     BYVAL strConfig AS WSTRING _                       ' __in const BSTR strConfig
   ) AS LONG                                            ' __retval_out LONG *pEventMask
   ' =====================================================================================
   METHOD Notify ( _                                    ' VTable offset = 32
     BYVAL ExitEvent AS LONG _                          ' __in LONG ExitEvent
   , BYVAL Context AS LONG _                            ' __in LONG Context
   )                                                    ' void
   ' =====================================================================================
   METHOD GetDescription ( _                            ' VTable offset = 36
   ) AS WSTRING                                         ' __retval_out BSTR *pstrDescription
   ' =====================================================================================

   ' =====================================================================================
   ' ICertExit2 method
   ' =====================================================================================
   METHOD GetManageModule ( _                           ' VTable offset = 40
   ) AS ICertManageModule                               ' __retval_out ICertManageModule **ppManageModule
   ' =====================================================================================

END INTERFACE

#ENDIF   ' /* __ICertExit2_INTERFACE_DEFINED__ */
